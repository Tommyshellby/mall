<!doctype html>
<html lang=en>
<head>
<meta charset=UTF-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<title>数据分析</title>
</head>
<style>body{font-size:15px;margin:0;width:100vw;padding:12px;box-sizing:border-box;overflow:hidden;height:100vh}table{width:100%;border-collapse:collapse;margin:20px 0;font-size:18px;text-align:left;background-color:#f9f9f9}td,th{padding:12px;border-bottom:1px solid #ddd}th{background-color:#e2e2e2}tr:hover{background-color:#d4edda}.button-container{display:flex;align-items:center}button{height:50px;margin:10px 0;margin-right:16px;padding:0 24px;background-color:#007bff;color:#fff;border:none;border-radius:5px;cursor:pointer;font-size:16px}button:hover{background-color:#0056b3}.last-button{margin-right:0}#totalAmount{margin-left:12px}</style>
<body>
<div style=display:flex;height:100%>
<div style=flex:1;height:100%;overflow-y:scroll>
<textarea id=inputText style=width:100%;padding:12px;box-sizing:border-box placeholder=请输入下注数据></textarea>
<div id=recordTip></div>
<div class=button-container>
<button onclick=generateTable()>统计</button>
<button onclick=recordNew()>录入新数据</button>
<button class=last-button onClick=clearTable()>清空当前统计数据</button>
</div>
<table>
<thead>
<tr>
<th>number</th>
<th>amount</th>
<th>risk</th>
<th>--</th>
</tr>
</thead>
<tbody>
<tr>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
</tbody>
</table>
</div>
<div style="flex:25% 0 0;margin-left:24px;overflow-y:scroll">
<div style=padding:12px;background-color:#d4edda;margin-bottom:12px>
<div>复制时注意事项</div>
<div>
1. 每一注单需单独占据一行，两注不同单之间需要换行. 举例说明：
<div>
<div style=color:red>错误的：1.2.4各3，03,04,05,08,各2</div>
<div style=display:flex;color:green>
<div>正确的：</div>
<div>
<div>1.2.4各3</div>
<div>03,04,05,08,各2</div>
</div>
</div>
</div>
</div>
</div>
<div>已统计记录：</div>
<textarea id=recordShow style=width:100%;padding:12px;box-sizing:border-box></textarea>
<div>已过滤数据：（部分可能是有效数据，请甄别）</div>
<textarea id=filterBox style=width:100%;padding:12px;box-sizing:border-box></textarea>
</div>
</div>
<script>function cloneDeep(e,t=!1){if(t)return JSON.parse(JSON.stringify(e));if(e instanceof Date)return new Date(e);if(e instanceof RegExp)return new RegExp(e);if("object"==typeof e&&null!==e){const t=e instanceof Array?[]:{};for(let n in e)t[n]=cloneDeep(e[n]);return t}return e}function checkHasChineseNumber(e){const t=["一","二","三","四","五","六","七","八","九","十","百","千","万"];for(const n of t)if(e.includes(n))return!0;return!1}function chineseToArabic(e){const t={"零":0,"一":1,"二":2,"三":3,"四":4,"五":5,"六":6,"七":7,"八":8,"九":9,"两":2,"十":10,"百":100,"千":1e3,"万":1e4,"亿":1e8};let n=0,i=0,o=0,s=1/0;const r=()=>{n+=i+o,i=o=0};for(const c of e){const e=t[c];void 0!==e&&(e>=10?[1e8,1e4].includes(e)?(r(),n*=e,s=e):(e>s&&r(),i+=(o||1)*e,o=0,s=e):o=10*o+e)}const c=n+i+o;return isNaN(c)?0:c}const checkSplitType=e=>e.includes("各")?"各":e.includes("每")?"每":e.includes("=")?"=":e.includes("买")?"买":"",greenCode=[6,5,17,16,28,27,39,38,49,11,22,21,33,32,44,43],redCode=[18,30,29,40,2,1,12,13,24,23,35,34,46,45,8,7,19],blueCode=[42,41,4,3,15,14,26,25,37,36,48,47,10,9,20,31];let preListData=[],listData=[],isRecord=!1,recordTime="",contentList=[],filterList=[];const zodiac=["鼠","牛","虎","兔","龙","蛇","马","羊","猴","鸡","狗","猪"],zodiacMap={"鼠":[6,18,30,42],"牛":[5,17,29,41],"虎":[4,16,28,40],"兔":[3,15,27,39],"龙":[2,14,26,38],"蛇":[1,13,25,37,49],"马":[12,24,36,48],"羊":[11,23,35,47],"猴":[10,22,34,46],"鸡":[9,21,33,45],"狗":[8,20,32,44],"猪":[7,19,31,43]};function findNonNegativeIntegers(e){return e.match(/\d+/g)||[]}function negativeToPositive(e){return e<0?-1*e:e}function getTextareaContent(){return document.getElementById("inputText").value}function isOtherCondition(e){if(findNonNegativeIntegers(e).length&&checkHasChineseNumber(e)){const t=chineseToArabic(e),n=findNonNegativeIntegers(e);if(t)return n.forEach((e=>{if(e=Number(e),listData.find((t=>Number(t.number)===e))){listData.find((t=>Number(t.number)===e)).amount+=Number(t)}else{let n="";greenCode.includes(e)?n="green":redCode.includes(e)?n="red":blueCode.includes(e)&&(n="blue");let i="";Object.keys(zodiacMap).forEach((t=>{zodiacMap[t].includes(e)&&(i=t)})),listData.push({number:e,color:n,zodiac:i,amount:Number(t),risk:"",eat:""})}})),!0}if(findNonNegativeIntegers(e).length&&["元","米","斤"].some((t=>e.includes(t)))){const t=findNonNegativeIntegers(e),n=t[t.length-1],i=t.slice(0,t.length-1);if(n)return i.forEach((e=>{if(e=Number(e),listData.find((t=>Number(t.number)===e))){listData.find((t=>Number(t.number)===e)).amount+=Number(n)}else{let t="";greenCode.includes(e)?t="green":redCode.includes(e)?t="red":blueCode.includes(e)&&(t="blue");let i="";Object.keys(zodiacMap).forEach((t=>{zodiacMap[t].includes(e)&&(i=t)})),listData.push({number:e,color:t,zodiac:i,amount:Number(n),risk:"",eat:""})}})),!0}return!1}function generateTable(){if(isRecord)return void alert("该数据已经统计过了，请勿重复统计");cloneDeep(listData);const e=getTextareaContent();if(!e)return void alert("请输入内容");e.match(/\r?\n/g);let t=e.split(/\r?\n/g);t=t.filter((e=>e)),console.log(t,"lines");for(let e=0;e<t.length;e++){const i=t[e];contentList.push(i+"\n");const o=(n=i).includes("各")?"各":n.includes("每")?"每":n.includes("=")?"=":n.includes("买")?"买":"";if(console.log(o,"splitType"),zodiac.some((e=>i.includes(e)))){let e=0;if(o){const t=i.split(o),n=t.length;if(e=findNonNegativeIntegers(t[n-1])[0],isNaN(e)){if(!checkHasChineseNumber(t[n-1])){isOtherCondition(i)||(filterList.push(i+"\n"),contentList.pop());continue}e=chineseToArabic(t[n-1])}else e=negativeToPositive(e)}else if(e=findNonNegativeIntegers(i)[0],isNaN(e)){if(!checkHasChineseNumber(i)){isOtherCondition(i)||(filterList.push(i+"\n"),contentList.pop());continue}e=chineseToArabic(i)}else e=negativeToPositive(e);zodiac.forEach((t=>{i.includes(t)&&zodiacMap[t].forEach((n=>{if(listData.find((e=>e.number===n))){console.log("存在重复");listData.find((e=>e.number===n)).amount+=Number(e)}else{let i="";greenCode.includes(n)?i="green":redCode.includes(n)?i="red":blueCode.includes(n)&&(i="blue"),listData.push({number:n,color:i,zodiac:t,amount:Number(e),risk:"",eat:""})}}))}))}else if(["红","绿","蓝"].some((e=>i.includes(e)))){let e=0;if(o){const t=i.split(o),n=t.length;if(e=findNonNegativeIntegers(t[n-1])[0],isNaN(e)){if(!checkHasChineseNumber(t[n-1])){isOtherCondition(i)||(filterList.push(i+"\n"),contentList.pop());continue}e=chineseToArabic(t[n-1])}else e=negativeToPositive(e)}else if(e=findNonNegativeIntegers(i)[0],isNaN(e)){if(!checkHasChineseNumber(i)){isOtherCondition(i)||(filterList.push(i+"\n"),contentList.pop());continue}e=chineseToArabic(i)}else e=negativeToPositive(e);if(i.includes("单")||i.includes("双")){if(i.includes("单")&&i.includes("双")){isOtherCondition(i)||(filterList.push(i+"\n"),contentList.pop());continue}{const t={"红":redCode,"绿":greenCode,"蓝":blueCode};["红","绿","蓝"].forEach((n=>{i.includes(n)&&t[n].forEach((t=>{if(!(i.includes("单")&&t%2==0||i.includes("双")&&t%2!=0))if(listData.find((e=>Number(e.number)===t))){listData.find((e=>Number(e.number)===t)).amount+=Number(e)}else{let i="";Object.keys(zodiacMap).forEach((e=>{zodiacMap[e].includes(t)&&(i=e)})),listData.push({number:t,color:"红"===n?"red":"绿"===n?"green":"blue",zodiac:i,amount:Number(e),risk:"",eat:""})}}))}))}}else{const t={"红":redCode,"绿":greenCode,"蓝":blueCode};["红","绿","蓝"].forEach((n=>{i.includes(n)&&t[n].forEach((t=>{if(listData.find((e=>Number(e.number)===t))){listData.find((e=>Number(e.number)===t)).amount+=Number(e)}else{let i="";Object.keys(zodiacMap).forEach((e=>{zodiacMap[e].includes(t)&&(i=e)})),listData.push({number:t,color:"红"===n?"red":"绿"===n?"green":"blue",zodiac:i,amount:Number(e),risk:"",eat:""})}}))}))}}else if(["单","双"].some((e=>i.includes(e)))){let e=0;if(o){const t=i.split(o),n=t.length;if(e=findNonNegativeIntegers(t[n-1])[0],isNaN(e)){if(!checkHasChineseNumber(t[n-1])){isOtherCondition(i)||(filterList.push(i+"\n"),contentList.pop());continue}e=chineseToArabic(t[n-1])}else e=negativeToPositive(e)}else if(e=findNonNegativeIntegers(i)[0],isNaN(e)){if(!checkHasChineseNumber(i)){isOtherCondition(i)||(filterList.push(i+"\n"),contentList.pop());continue}e=chineseToArabic(i)}else e=negativeToPositive(e);for(let t=1;t<=49;t++){if(i.includes("单")&&i.includes("双"));else{if(i.includes("单")&&t%2!=1)continue;if(i.includes("双")&&t%2!=0)continue}if(listData.find((e=>Number(e.number)===t))){listData.find((e=>Number(e.number)===t)).amount+=Number(e)}else{let n="";greenCode.includes(t)?n="green":redCode.includes(t)?n="red":blueCode.includes(t)&&(n="blue");let i="";Object.keys(zodiacMap).forEach((e=>{zodiacMap[e].includes(t)&&(i=e)})),listData.push({number:t,color:n,zodiac:i,amount:Number(e),risk:"",eat:""})}}}else if(i.includes("小数")||i.includes("大数")){let e=0;if(o){const t=i.split(o),n=t.length;if(e=findNonNegativeIntegers(t[n-1])[0],isNaN(e)){if(!checkHasChineseNumber(t[n-1])){isOtherCondition(i)||(filterList.push(i+"\n"),contentList.pop());continue}e=chineseToArabic(t[n-1])}else e=negativeToPositive(e)}else if(e=findNonNegativeIntegers(i)[0],isNaN(e)){if(!checkHasChineseNumber(i)){isOtherCondition(i)||(filterList.push(i+"\n"),contentList.pop());continue}e=chineseToArabic(i)}else e=negativeToPositive(e);const t=i.includes("小数")?1:25,n=i.includes("小数")?24:49;for(let i=t;i<=n;i++)if(listData.find((e=>Number(e.number)===i))){listData.find((e=>Number(e.number)===i)).amount+=Number(e)}else{let t="";greenCode.includes(i)?t="green":redCode.includes(i)?t="red":blueCode.includes(i)&&(t="blue");let n="";Object.keys(zodiacMap).forEach((e=>{zodiacMap[e].includes(i)&&(n=e)})),listData.push({number:i,color:t,zodiac:n,amount:Number(e),risk:"",eat:""})}}else if(o){const e=i.split(o),t=e.length,n=e[0];console.log(e[t.length-1],"==");let s=findNonNegativeIntegers(e[t-1])[0];if(isNaN(s)){if(!checkHasChineseNumber(e[t-1])){isOtherCondition(i)||(filterList.push(i+"\n"),contentList.pop());continue}s=chineseToArabic(e[t-1])}else s=negativeToPositive(s);const r=findNonNegativeIntegers(n).map((e=>negativeToPositive(Number(e))));if(0===r.length){isOtherCondition(i)||(filterList.push(i+"\n"),contentList.pop());continue}r.forEach((e=>{if(e=Number(e),listData.find((t=>Number(t.number)===e))){listData.find((t=>Number(t.number)===e)).amount+=Number(s)}else{let t="";greenCode.includes(e)?t="green":redCode.includes(e)?t="red":blueCode.includes(e)&&(t="blue");let n="";Object.keys(zodiacMap).forEach((t=>{zodiacMap[t].includes(e)&&(n=t)})),listData.push({number:e,color:t,zodiac:n,amount:Number(s),risk:"",eat:""})}}))}else isOtherCondition(i)||(filterList.push(i+"\n"),contentList.pop())}var n;isRecord=!0,listData.forEach((e=>{const t=46*-e.amount;let n=0;listData.forEach((e=>{n+=e.amount})),e.risk=t+n})),listData.sort(((e,t)=>e.risk>t.risk?1:e.risk<t.risk?-1:0)),console.log(listData),updateContent(listData)}function recordNew(){const e=document.getElementById("inputText");e.value="",e.toggleAttribute("disabled"),isRecord=!1,console.log(33)}function updateContent(e){const t=document.querySelector("table tbody");t.innerHTML="";document.querySelector("table thead").innerHTML=`\n        <tr>\n          <th>号码</th>\n          <th>金额（总：${e.reduce(((e,t)=>e+t.amount),0)}）</th>\n          <th>风险</th>\n        </tr>\n      `,e.forEach((e=>{const n=document.createElement("tr"),i=e.number>=10?e.number:"0"+e.number;n.innerHTML=`\n          <td style="display: flex;align-items: center;">\n            <div style="background-color: ${e.color};color:#fff;border-radius: 50%;width: 40px;height:40px;text-align:center;line-height:40px;margin-right: 12px">${i}</div>\n          </td>\n          <td>${e.amount}</td>\n          <td style="color: ${e.risk>0?"red":"green"}">${e.risk}</td>\n        `,t.appendChild(n)}));document.getElementById("recordTip").innerHTML="数据已经统计："+(new Date).toLocaleString();document.getElementById("inputText").setAttribute("disabled",!0);const n=document.getElementById("recordShow");console.log(contentList,"contentList"),n.value=contentList.join(""),n.style.height="auto",n.style.height=(n.scrollHeight>300?300:n.scrollHeight)+"px",n.setAttribute("disabled",!0);const i=document.getElementById("filterBox");i.value=filterList.join(""),i.style.height="auto",i.style.height=(i.scrollHeight>300?300:i.scrollHeight)+"px",i.setAttribute("disabled",!0)}function clearTable(){if(window.confirm("确定要清空当前统计数据吗？")){const e=document.getElementById("inputText");e.value="",e.toggleAttribute("disabled"),listData=[],isRecord=!1,contentList=[],filterList=[];document.querySelector("table tbody").innerHTML="";document.querySelector("table thead").innerHTML="\n          <tr>\n            <th>号码</th>\n            <th>金额</th>\n            <th>风险</th>\n          </tr>\n        ";document.getElementById("recordTip").innerHTML="";document.getElementById("filterBox").value="";document.getElementById("recordShow").value=""}}function adjustTextareaHeight(){const e=document.getElementById("inputText");e.style.height="auto",e.style.height=e.scrollHeight+"px"}document.getElementById("inputText").addEventListener("input",adjustTextareaHeight),window.onload=adjustTextareaHeight</script>
</body>
</html>
